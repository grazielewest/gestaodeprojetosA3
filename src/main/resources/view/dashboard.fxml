<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="Controller.DashboardController">
    <top>
        <VBox spacing="0">
            <MenuBar style="-fx-background-color: #2c3e50;">
                <Menu text="Arquivo" style="-fx-text-fill: white;">
                    <MenuItem text="Sair" onAction="#handleSair"/>
                </Menu>
                <Menu text="Projetos" style="-fx-text-fill: white;">
                    <MenuItem text="Gerenciar Projetos" onAction="#handleGerenciarProjetos"/>
                    <MenuItem text="Novo Projeto" onAction="#handleNovoProjeto"/>
                </Menu>
                <!-- 🔥 NOVO MENU: Tarefas -->
                <Menu text="Tarefas" style="-fx-text-fill: white;">
                    <MenuItem text="Gerenciar Tarefas" onAction="#handleGerenciarTarefas"/>
                    <MenuItem text="Nova Tarefa" onAction="#handleNovaTarefa"/>
                </Menu>
                <Menu text="Relatórios" style="-fx-text-fill: white;">
                    <MenuItem text="Relatório de Projetos" onAction="#handleRelatorioProjetos"/>
                    <MenuItem text="Relatório de Tarefas" onAction="#handleRelatorioTarefas"/>
                </Menu>
                <Menu text="Ajuda" style="-fx-text-fill: white;">
                    <MenuItem text="Sobre"/>
                </Menu>
            </MenuBar>

            <!-- Header com título e informações do usuário -->
            <HBox style="-fx-background-color: #34495e; -fx-padding: 15px 20px;" alignment="CENTER_LEFT">
                <Label text="Dashboard - Gestão de Projetos"
                       style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="lblUsuario" text="Usuário: Admin"
                       style="-fx-text-fill: #ecf0f1; -fx-font-size: 14px;"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" style="-fx-background-color: #ecf0f1;">
            <Tab text="Dashboard">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="25" style="-fx-padding: 25px;">
                        <!-- Título de boas-vindas -->
                        <VBox spacing="5">
                            <Label text="Bem-vindo ao Sistema de Gestão de Projetos"
                                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                            <Label text="Aqui está um resumo das suas atividades"
                                   style="-fx-font-size: 14px; -fx-text-fill: #7f8c8d;"/>
                        </VBox>

                        <!-- Grid de métricas -->
                        <GridPane hgap="20" vgap="20">
                            <columnConstraints>
                                <ColumnConstraints percentWidth="20"/>
                                <ColumnConstraints percentWidth="20"/>
                                <ColumnConstraints percentWidth="20"/>
                                <ColumnConstraints percentWidth="20"/>
                                <ColumnConstraints percentWidth="20"/>
                            </columnConstraints>

                            <!-- Cartão 1 - Projetos Ativos -->
                            <VBox style="-fx-background-color: #3498db; -fx-padding: 25px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0.5, 0, 2);"
                                  spacing="8" GridPane.columnIndex="0">
                                <Label text="📊" style="-fx-font-size: 24px;"/>
                                <Label text="Projetos Ativos" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                                <Label fx:id="lblProjetosAtivos" text="0"
                                       style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                            </VBox>

                            <!-- Cartão 2 - Tarefas Pendentes -->
                            <VBox style="-fx-background-color: #2ecc71; -fx-padding: 25px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0.5, 0, 2);"
                                  spacing="8" GridPane.columnIndex="1">
                                <Label text="✅" style="-fx-font-size: 24px;"/>
                                <Label text="Tarefas Pendentes" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                                <Label fx:id="lblTarefasPendentes" text="0"
                                       style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                            </VBox>

                            <!-- Cartão 3 - Projetos Atrasados -->
                            <VBox style="-fx-background-color: #e74c3c; -fx-padding: 25px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0.5, 0, 2);"
                                  spacing="8" GridPane.columnIndex="2">
                                <Label text="⏰" style="-fx-font-size: 24px;"/>
                                <Label text="Projetos Atrasados" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                                <Label fx:id="lblProjetosAtrasados" text="0"
                                       style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                            </VBox>

                            <!-- Cartão 4 - Tarefas Atrasadas -->
                            <VBox style="-fx-background-color: #e67e22; -fx-padding: 25px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0.5, 0, 2);"
                                  spacing="8" GridPane.columnIndex="3">
                                <Label text="🚨" style="-fx-font-size: 24px;"/>
                                <Label text="Tarefas Atrasadas" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                                <Label fx:id="lblTarefasAtrasadas" text="0"
                                       style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                                <Label text="Necessita atenção" style="-fx-text-fill: #ecf0f1; -fx-font-size: 12px;"/>
                            </VBox>

                            <!-- Cartão 5 - Equipes -->
                            <VBox style="-fx-background-color: #f39c12; -fx-padding: 25px; -fx-background-radius: 12px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0.5, 0, 2);"
                                  spacing="8" GridPane.columnIndex="4">
                                <Label text="👥" style="-fx-font-size: 24px;"/>
                                <Label text="Equipes Ativas" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                                <Label fx:id="lblEquipesAtivas" text="0"
                                       style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                            </VBox>
                        </GridPane>

                        <!-- Seção de ações rápidas -->
                        <VBox spacing="15">
                            <Label text="Ações Rápidas" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                            <HBox spacing="15" alignment="CENTER_LEFT">
                                <Button text="👥 Gerenciar Usuários" onAction="#handleGerenciarUsuarios"
                                        style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 160px; -fx-pref-height: 60px; -fx-background-radius: 8px; -fx-font-size: 14px;"/>
                                <Button text="🏢 Gerenciar Equipes" onAction="#handleGerenciarEquipes"
                                        style="-fx-background-color: #1abc9c; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 160px; -fx-pref-height: 60px; -fx-background-radius: 8px; -fx-font-size: 14px;"/>
                                <Button text="📋 Novo Projeto" onAction="#handleNovoProjeto"
                                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 160px; -fx-pref-height: 60px; -fx-background-radius: 8px; -fx-font-size: 14px;"/>
                                <Button text="📝 Nova Tarefa" onAction="#handleNovaTarefa"
                                        style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 160px; -fx-pref-height: 60px; -fx-background-radius: 8px; -fx-font-size: 14px;"/>
                                <Button text="📊 Relatórios" onAction="#handleRelatorioProjetos"
                                        style="-fx-background-color: #e67e22; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 160px; -fx-pref-height: 60px; -fx-background-radius: 8px; -fx-font-size: 14px;"/>
                            </HBox>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>

            <Tab text="Projetos">
                <VBox spacing="15" style="-fx-padding: 20px;">
                    <!-- Cabeçalho da seção de projetos -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Gerenciamento de Projetos"
                               style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="lblTotalProjetos" text="Total: 0 projetos"
                               style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </HBox>

                    <!-- Barra de ferramentas -->
                    <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-background-color: #f8f9fa; -fx-padding: 15px; -fx-background-radius: 8px;">
                        <Button text="➕ Novo Projeto" onAction="#handleNovoProjeto"
                                style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 120px;"/>
                        <Button text="✏️ Editar" onAction="#handleEditarProjeto"
                                style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Button text="🗑️ Excluir" onAction="#handleExcluirProjeto"
                                style="-fx-background-color: #dc3545; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Button text="👁️ Visualizar" onAction="#handleVisualizarProjeto"
                                style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Button text="📋 Tarefas" onAction="#handleVerTarefasProjeto"
                                style="-fx-background-color: #17a2b8; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <TextField promptText="Buscar projetos..." style="-fx-pref-width: 200px;"/>
                        <Button text="🔍 Buscar" style="-fx-background-color: #ffc107; -fx-text-fill: black; -fx-font-weight: bold;"/>
                    </HBox>

                    <!-- Tabela de projetos -->
                    <TableView fx:id="tabelaProjetos" style="-fx-pref-height: 400px; -fx-background-radius: 8px;">
                        <columns>
                            <TableColumn fx:id="colId" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="colNome" text="Nome do Projeto" prefWidth="250"/>
                            <TableColumn fx:id="colStatus" text="Status" prefWidth="120"/>
                            <TableColumn fx:id="colDataInicio" text="Data Início" prefWidth="110"/>
                            <TableColumn fx:id="colDataFim" text="Data Fim" prefWidth="110"/>
                            <TableColumn fx:id="colResponsavel" text="Responsável" prefWidth="150"/>
                            <TableColumn fx:id="colEquipes" text="Equipes" prefWidth="200"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- 🔥 NOVA ABA: Tarefas -->
            <Tab text="Tarefas">
                <VBox spacing="15" style="-fx-padding: 20px;">
                    <!-- Cabeçalho da seção de tarefas -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Gerenciamento de Tarefas"
                               style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="lblTotalTarefas" text="Total: 0 tarefas"
                               style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </HBox>

                    <!-- Barra de ferramentas das tarefas -->
                    <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-background-color: #f8f9fa; -fx-padding: 15px; -fx-background-radius: 8px;">
                        <Button text="➕ Nova Tarefa" onAction="#handleNovaTarefa"
                                style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 120px;"/>
                        <Button text="✏️ Editar" onAction="#handleEditarTarefa"
                                style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Button text="🗑️ Excluir" onAction="#handleExcluirTarefa"
                                style="-fx-background-color: #dc3545; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Button text="✅ Concluir" onAction="#handleConcluirTarefa"
                                style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 100px;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <ComboBox fx:id="cbFiltroProjetos" promptText="Filtrar por projeto" style="-fx-pref-width: 200px;"/>
                        <ComboBox fx:id="cbFiltroStatus" promptText="Filtrar por status" style="-fx-pref-width: 150px;"/>
                        <TextField promptText="Buscar tarefas..." style="-fx-pref-width: 200px;"/>
                        <Button text="🔍 Buscar" style="-fx-background-color: #ffc107; -fx-text-fill: black; -fx-font-weight: bold;"/>
                    </HBox>

                    <!-- Tabela de tarefas -->
                    <TableView fx:id="tabelaTarefas" style="-fx-pref-height: 400px; -fx-background-radius: 8px;">
                        <columns>
                            <TableColumn fx:id="colTarefaId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colTarefaTitulo" text="Título" prefWidth="200"/>
                            <TableColumn fx:id="colTarefaProjeto" text="Projeto" prefWidth="150"/>
                            <TableColumn fx:id="colTarefaResponsavel" text="Responsável" prefWidth="120"/>
                            <TableColumn fx:id="colTarefaStatus" text="Status" prefWidth="100"/>
                            <TableColumn fx:id="colTarefaPrioridade" text="Prioridade" prefWidth="80"/>
                            <TableColumn fx:id="colTarefaInicioPrevisto" text="Início Previsto" prefWidth="100"/>
                            <TableColumn fx:id="colTarefaFimPrevisto" text="Fim Previsto" prefWidth="100"/>
                            <TableColumn fx:id="colTarefaAtraso" text="Situação" prefWidth="80"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>
        </TabPane>
    </center>

    <bottom>
        <HBox alignment="CENTER" style="-fx-background-color: #34495e; -fx-padding: 10px;">
            <Label fx:id="lblStatus" text="✅ Conectado como Admin | Sistema: Gestão de Projetos v1.0 | © 2024"
                   style="-fx-text-fill: #ecf0f1; -fx-font-size: 12px;"/>
        </HBox>
    </bottom>
</BorderPane>